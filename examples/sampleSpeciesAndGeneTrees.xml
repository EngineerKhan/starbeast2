<beast version="2.0"
       namespace="starbeast2
                 :starbeast2.utils
                 :beast.core
                 :beast.util
                 :beast.core.util
                 :beast.evolution.tree
                 :beast.evolution.speciation
                 :beast.evolution.alignment
                 :beast.evolution.operators">

    <taxonSet spec="TaxonSet" id="taxonSet">
        <taxon spec="Taxon" id="a"/>
        <taxon spec="Taxon" id="b"/>
        <taxon spec="Taxon" id="c"/>
    </taxonSet>

    <run chainLength="100000000" id="mcmc" spec="MCMC" storeEvery="100000">
        <state id="state" storeEvery="10000">
            <stateNode id="tree" spec="TreeParser"
                       newick="((a:1.5,b:0):0.5,c:1)"
                       adjustTipHeights="false" IsLabelledNewick="true"/>
        </state>

        <distribution spec="SABirthDeathModel" id="probability" tree="@tree" >
            <parameter name="origin" value ="3.0"/>
            <parameter name="birthRate" value ="1.0"/>
            <parameter name="deathRate" value ="0.5"/>
            <parameter name="removalProbability" value="0.0"/>
            <parameter name="samplingRate" value="0.1"/>
            <parameter name="rho" value="0.1"/>
        </distribution>

        <operator spec="LeafToSampledAncestorJump" tree="@tree" weight="10.0"/>
        <operator spec="SAWilsonBalding" tree="@tree" weight="10.0"/>
        <operator spec="SAExchange" isNarrow="false" tree="@tree" weight="10.0"/>
        <operator spec="SAExchange" tree="@tree" weight="10.0"/>
        <operator spec="SAUniform" tree="@tree" weight="20.0"/>
        <operator spec="SAScaleOperator" rootOnly="true" scaleFactor="0.98" tree="@tree" weight="1.0"/>
        <operator spec="SAScaleOperator" scaleFactor="0.95" tree="@tree" weight="3.0"/>

        <logger logEvery="100000">
            <log idref="probability"/>
            <log spec="ESS" arg="@probability"/>
        </logger>

        <logger fileName="$(filebase).species.trees" logEvery="1000" mode="tree">
            <log idref="tree"/>
        </logger>

        <logger fileName="$(filebase).gene.trees" logEvery="1000" mode="tree">
            <log spec="SimulatedGeneTreeLogger">
                <simulatedGeneTree id="geneTree" spec="SimulatedGeneTree"
                                   speciesTree="@tree">
                    <sampleCounts spec="TraitSet" traitname="sampleCounts" taxa="@taxonSet">
                        a=2,
                        b=1,
                        c=1
                    </sampleCounts>
                </simulatedGeneTree>
            </log>
        </logger>

        <logger spec="TreeTopologyDistLogger" fileName="$(filebase).gene.report" logEvery="1000"
                tree="@geneTree" burninSamples="10000" isSpeciesTree="false"/>

        <logger spec="TreeTopologyDistLogger" fileName="$(filebase).species.report" logEvery="1000"
                tree="@geneTree" burninSamples="10000" isSpeciesTree="true"/>

    </run>
</beast>
